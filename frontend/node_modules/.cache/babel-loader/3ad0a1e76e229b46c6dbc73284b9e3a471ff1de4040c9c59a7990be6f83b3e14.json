{"ast":null,"code":"import React,{useEffect,useState}from'react';import{useTranslation}from'react-i18next';import{useAuth}from'../contexts/AuthContext';import FundraiserService from'../services/fundraiser.service';import FundraiserCard from'../components/fundraiser/FundraiserCard';import DonationModal from'../components/fundraiser/DonationModal';import NewFundraiserModal from'../components/fundraiser/NewFundraiserModal';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const FundraiserPage=()=>{const{t}=useTranslation();const{isAuthenticated}=useAuth();const[fundraisers,setFundraisers]=useState([]);const[loading,setLoading]=useState(true);const[error,setError]=useState('');const[selectedFundraiser,setSelectedFundraiser]=useState(null);const[showDonationModal,setShowDonationModal]=useState(false);const[showNewFundraiserModal,setShowNewFundraiserModal]=useState(false);const[successMessage,setSuccessMessage]=useState('');useEffect(()=>{const fetchFundraisers=async()=>{try{setLoading(true);const response=await FundraiserService.getAllFundraisers();setFundraisers(response.results||[]);}catch(error){setError('Failed to load fundraisers. Please try again later.');console.error(error);}finally{setLoading(false);}};fetchFundraisers();},[]);const handleDonate=fundraiser=>{setSelectedFundraiser(fundraiser);setShowDonationModal(true);};const handleDonationSubmit=async donationData=>{try{await FundraiserService.donate(selectedFundraiser.id,donationData);const response=await FundraiserService.getAllFundraisers();setFundraisers(response.results||[]);setShowDonationModal(false);setSelectedFundraiser(null);setSuccessMessage(t('fundraiser.donationSuccess'));setTimeout(()=>setSuccessMessage(''),5000);}catch(error){console.error(error);setError(t('fundraiser.donationError'));setTimeout(()=>setError(''),5000);}};const handleNewFundraiserSubmit=async fundraiserData=>{try{await FundraiserService.createFundraiser(fundraiserData);const response=await FundraiserService.getAllFundraisers();setFundraisers(response.results||[]);setShowNewFundraiserModal(false);setSuccessMessage(t('fundraiser.createSuccess'));setTimeout(()=>setSuccessMessage(''),5000);}catch(error){console.error(error);setError(t('fundraiser.createError'));setTimeout(()=>setError(''),5000);}};return/*#__PURE__*/_jsxs(\"div\",{className:\"bg-gray-50 min-h-screen\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"bg-indigo-900 text-white py-16\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"container mx-auto px-6 text-center\",children:[/*#__PURE__*/_jsx(\"h1\",{className:\"text-3xl md:text-4xl font-bold mb-4\",children:t('fundraiser.title')}),/*#__PURE__*/_jsx(\"p\",{className:\"text-xl text-indigo-200 max-w-2xl mx-auto mb-8\",children:t('fundraiser.subtitle')}),isAuthenticated&&/*#__PURE__*/_jsx(\"button\",{onClick:()=>setShowNewFundraiserModal(true),className:\"bg-white text-indigo-900 px-6 py-3 rounded-lg font-bold hover:bg-indigo-50 transition duration-300\",children:t('fundraiser.startFundraiser')})]})}),/*#__PURE__*/_jsxs(\"div\",{className:\"container mx-auto px-6 py-12\",children:[successMessage&&/*#__PURE__*/_jsx(\"div\",{className:\"bg-green-100 border border-green-400 text-green-700 px-4 py-3 rounded mb-6\",children:successMessage}),error&&/*#__PURE__*/_jsx(\"div\",{className:\"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded mb-6\",children:error}),loading?/*#__PURE__*/_jsx(\"div\",{className:\"flex justify-center py-12\",children:/*#__PURE__*/_jsx(\"div\",{className:\"animate-spin rounded-full h-16 w-16 border-t-2 border-b-2 border-indigo-900\"})}):fundraisers.length===0?/*#__PURE__*/_jsxs(\"div\",{className:\"text-center py-12\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-gray-600 text-lg mb-4\",children:t('fundraiser.noFundraisers')}),isAuthenticated&&/*#__PURE__*/_jsx(\"button\",{onClick:()=>setShowNewFundraiserModal(true),className:\"bg-indigo-900 text-white px-6 py-3 rounded-lg font-bold hover:bg-indigo-800 transition duration-300\",children:t('fundraiser.startFundraiser')})]}):/*#__PURE__*/_jsx(\"div\",{className:\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8\",children:fundraisers.map(fundraiser=>/*#__PURE__*/_jsx(FundraiserCard,{fundraiser:fundraiser,onDonate:()=>handleDonate(fundraiser)},fundraiser.id))})]}),showDonationModal&&selectedFundraiser&&/*#__PURE__*/_jsx(DonationModal,{fundraiser:selectedFundraiser,onClose:()=>{setShowDonationModal(false);setSelectedFundraiser(null);},onSubmit:handleDonationSubmit,isAuthenticated:isAuthenticated}),showNewFundraiserModal&&/*#__PURE__*/_jsx(NewFundraiserModal,{onClose:()=>setShowNewFundraiserModal(false),onSubmit:handleNewFundraiserSubmit})]});};export default FundraiserPage;","map":{"version":3,"names":["React","useEffect","useState","useTranslation","useAuth","FundraiserService","FundraiserCard","DonationModal","NewFundraiserModal","jsx","_jsx","jsxs","_jsxs","FundraiserPage","t","isAuthenticated","fundraisers","setFundraisers","loading","setLoading","error","setError","selectedFundraiser","setSelectedFundraiser","showDonationModal","setShowDonationModal","showNewFundraiserModal","setShowNewFundraiserModal","successMessage","setSuccessMessage","fetchFundraisers","response","getAllFundraisers","results","console","handleDonate","fundraiser","handleDonationSubmit","donationData","donate","id","setTimeout","handleNewFundraiserSubmit","fundraiserData","createFundraiser","className","children","onClick","length","map","onDonate","onClose","onSubmit"],"sources":["C:/Users/bogda/Pyton programs/Web application OP/MILITEX/militex/frontend/src/pages/FundraiserPage.js"],"sourcesContent":["import React, { useEffect, useState } from 'react';\r\nimport { useTranslation } from 'react-i18next';\r\nimport { useAuth } from '../contexts/AuthContext';\r\nimport FundraiserService from '../services/fundraiser.service';\r\nimport FundraiserCard from '../components/fundraiser/FundraiserCard';\r\nimport DonationModal from '../components/fundraiser/DonationModal';\r\nimport NewFundraiserModal from '../components/fundraiser/NewFundraiserModal';\r\n\r\nconst FundraiserPage = () => {\r\n  const { t } = useTranslation();\r\n  const { isAuthenticated } = useAuth();\r\n  const [fundraisers, setFundraisers] = useState([]);\r\n  const [loading, setLoading] = useState(true);\r\n  const [error, setError] = useState('');\r\n  const [selectedFundraiser, setSelectedFundraiser] = useState(null);\r\n  const [showDonationModal, setShowDonationModal] = useState(false);\r\n  const [showNewFundraiserModal, setShowNewFundraiserModal] = useState(false);\r\n  const [successMessage, setSuccessMessage] = useState('');\r\n\r\n  useEffect(() => {\r\n    const fetchFundraisers = async () => {\r\n      try {\r\n        setLoading(true);\r\n        const response = await FundraiserService.getAllFundraisers();\r\n        setFundraisers(response.results || []);\r\n      } catch (error) {\r\n        setError('Failed to load fundraisers. Please try again later.');\r\n        console.error(error);\r\n      } finally {\r\n        setLoading(false);\r\n      }\r\n    };\r\n\r\n    fetchFundraisers();\r\n  }, []);\r\n\r\n  const handleDonate = (fundraiser) => {\r\n    setSelectedFundraiser(fundraiser);\r\n    setShowDonationModal(true);\r\n  };\r\n\r\n  const handleDonationSubmit = async (donationData) => {\r\n    try {\r\n      await FundraiserService.donate(selectedFundraiser.id, donationData);\r\n\r\n      const response = await FundraiserService.getAllFundraisers();\r\n      setFundraisers(response.results || []);\r\n\r\n      setShowDonationModal(false);\r\n      setSelectedFundraiser(null);\r\n\r\n      setSuccessMessage(t('fundraiser.donationSuccess'));\r\n      setTimeout(() => setSuccessMessage(''), 5000);\r\n    } catch (error) {\r\n      console.error(error);\r\n      setError(t('fundraiser.donationError'));\r\n      setTimeout(() => setError(''), 5000);\r\n    }\r\n  };\r\n\r\n  const handleNewFundraiserSubmit = async (fundraiserData) => {\r\n    try {\r\n      await FundraiserService.createFundraiser(fundraiserData);\r\n\r\n      const response = await FundraiserService.getAllFundraisers();\r\n      setFundraisers(response.results || []);\r\n\r\n      setShowNewFundraiserModal(false);\r\n\r\n      setSuccessMessage(t('fundraiser.createSuccess'));\r\n      setTimeout(() => setSuccessMessage(''), 5000);\r\n    } catch (error) {\r\n      console.error(error);\r\n      setError(t('fundraiser.createError'));\r\n      setTimeout(() => setError(''), 5000);\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div className=\"bg-gray-50 min-h-screen\">\r\n      <div className=\"bg-indigo-900 text-white py-16\">\r\n        <div className=\"container mx-auto px-6 text-center\">\r\n          <h1 className=\"text-3xl md:text-4xl font-bold mb-4\">{t('fundraiser.title')}</h1>\r\n          <p className=\"text-xl text-indigo-200 max-w-2xl mx-auto mb-8\">\r\n            {t('fundraiser.subtitle')}\r\n          </p>\r\n\r\n          {isAuthenticated && (\r\n            <button\r\n              onClick={() => setShowNewFundraiserModal(true)}\r\n              className=\"bg-white text-indigo-900 px-6 py-3 rounded-lg font-bold hover:bg-indigo-50 transition duration-300\"\r\n            >\r\n              {t('fundraiser.startFundraiser')}\r\n            </button>\r\n          )}\r\n        </div>\r\n      </div>\r\n\r\n      <div className=\"container mx-auto px-6 py-12\">\r\n        {/* Success Message */}\r\n        {successMessage && (\r\n          <div className=\"bg-green-100 border border-green-400 text-green-700 px-4 py-3 rounded mb-6\">\r\n            {successMessage}\r\n          </div>\r\n        )}\r\n\r\n        {/* Error Message */}\r\n        {error && (\r\n          <div className=\"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded mb-6\">\r\n            {error}\r\n          </div>\r\n        )}\r\n\r\n        {loading ? (\r\n          <div className=\"flex justify-center py-12\">\r\n            <div className=\"animate-spin rounded-full h-16 w-16 border-t-2 border-b-2 border-indigo-900\"></div>\r\n          </div>\r\n        ) : fundraisers.length === 0 ? (\r\n          <div className=\"text-center py-12\">\r\n            <p className=\"text-gray-600 text-lg mb-4\">{t('fundraiser.noFundraisers')}</p>\r\n            {isAuthenticated && (\r\n              <button\r\n                onClick={() => setShowNewFundraiserModal(true)}\r\n                className=\"bg-indigo-900 text-white px-6 py-3 rounded-lg font-bold hover:bg-indigo-800 transition duration-300\"\r\n              >\r\n                {t('fundraiser.startFundraiser')}\r\n              </button>\r\n            )}\r\n          </div>\r\n        ) : (\r\n          <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8\">\r\n            {fundraisers.map((fundraiser) => (\r\n              <FundraiserCard\r\n                key={fundraiser.id}\r\n                fundraiser={fundraiser}\r\n                onDonate={() => handleDonate(fundraiser)}\r\n              />\r\n            ))}\r\n          </div>\r\n        )}\r\n      </div>\r\n\r\n      {/* Donation Modal */}\r\n      {showDonationModal && selectedFundraiser && (\r\n        <DonationModal\r\n          fundraiser={selectedFundraiser}\r\n          onClose={() => {\r\n            setShowDonationModal(false);\r\n            setSelectedFundraiser(null);\r\n          }}\r\n          onSubmit={handleDonationSubmit}\r\n          isAuthenticated={isAuthenticated}\r\n        />\r\n      )}\r\n\r\n      {/* New Fundraiser Modal */}\r\n      {showNewFundraiserModal && (\r\n        <NewFundraiserModal\r\n          onClose={() => setShowNewFundraiserModal(false)}\r\n          onSubmit={handleNewFundraiserSubmit}\r\n        />\r\n      )}\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default FundraiserPage;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}